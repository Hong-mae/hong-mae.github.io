{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/react-drag-and-drop-list-2","result":{"data":{"markdownRemark":{"id":"069ccad3-e97a-5027-b37e-93ac3c954a64","html":"<ul>\n<li><a href=\"/posts/react-drag-and-drop-list\">React로 Drag and Drop List 만들기 #1</a></li>\n<li><a href=\"/posts/react-drag-and-drop-list-2\">React로 Drag and Drop List 만들기(Swap) #2</a></li>\n<li><a href=\"/posts/react-drag-and-drop-list-sortable\">React로 Drag and Drop List 만들기(Sortable) #3</a></li>\n</ul>\n<p>지난 포스트에서 state를 이용해 리스트를 보여줬다.</p>\n<p>Drag and Drop API를 이용해서 Drag 한 요소와 Drop 한 위치의 요소를 서로 변경(Swap)하는 코드를 먼저 작성해보기로 했다.</p>\n<iframe width=\"100%\" height=\"500\" style=\"display:block\" src=\"//jsfiddle.net/Chill_bi/vt3c802w/62/embedded/js,result/dark/\" allowfullscreen=\"allowfullscreen\" allowpaymentrequest frameborder=\"0\"></iframe>\n<p><html><head></head><body><div id=\"gist106309433\" class=\"gist\">\n    <div class=\"gist-file\" translate=\"no\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-drag_and_drop_list_swap-js\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript  \">\n\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody>\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC13\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">const</span> <span class=\"pl-kos\">[</span> <span class=\"pl-s1\">grab</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">setGrab</span> <span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">React</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">useState</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">null</span><span class=\"pl-kos\">)</span></td>\n      </tr>\n      \n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC15\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">const</span> <span class=\"pl-en\">_onDragOver</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">e</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC16\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">preventDefault</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC17\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-kos\">}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC18\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC19\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">const</span> <span class=\"pl-en\">_onDragStart</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">e</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC20\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">setGrab</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">target</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC21\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">target</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">classList</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"grabbing\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC22\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">dataTransfer</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">effectAllowed</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"move\"</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC23\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">dataTransfer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">setData</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"text/html\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">target</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC24\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-kos\">}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC25\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC26\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">const</span> <span class=\"pl-en\">_onDragEnd</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">e</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC27\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">target</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">classList</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">remove</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"grabbing\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC28\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC29\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">dataTransfer</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">dropEffect</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"move\"</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC30\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-kos\">}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC31\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC32\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">const</span> <span class=\"pl-en\">_onDrop</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">e</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC33\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">let</span> <span class=\"pl-s1\">grabPosition</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Number</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">grab</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">dataset</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">position</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC34\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">let</span> <span class=\"pl-s1\">targetPosition</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Number</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">target</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">dataset</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">position</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC35\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC36\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">let</span> <span class=\"pl-s1\">_list</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span> ...<span class=\"pl-s1\">lists</span> <span class=\"pl-kos\">]</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC37\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">_list</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">grabPosition</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">_list</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">splice</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">targetPosition</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">_list</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">grabPosition</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC38\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC39\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s1\">setLists</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">_list</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-drag_and_drop_list_swap-js-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-drag_and_drop_list_swap-js-LC40\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-kos\">}</span></td>\n      </tr>\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/Moong-bee/fe59b01412daea0807dd39c45cf52fd8/raw/114de9f948ff8083e2c411513ff36d9ed3b8ff43/drag_and_drop_list_swap.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/Moong-bee/fe59b01412daea0807dd39c45cf52fd8#file-drag_and_drop_list_swap-js\">drag_and_drop_list_swap.js</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html></p>\n<h3 id=\"설명\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EB%AA%85\" aria-label=\"설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설명</h3>\n<p>우선 함수는 다음과 같다</p>\n<ol>\n<li>_onDragOver</li>\n<li>_onDragStart</li>\n<li>_onDragEnd</li>\n<li>_onDrop</li>\n</ol>\n<p>함수의 호출 순서는 (1), 2, 4, 3 순으로 호출된다. 1번의 경우 밀리초 단위로 실행되기 때문에 순서에 영향이 없다.</p>\n<p>코드의 설명은 다음과 같다.</p>\n<ul>\n<li>[13] grab, setGrab : 현재 drag를 위해 선택된 요소를 저장하기 위해 state를 하나 더 추가했다.</li>\n<li>[14-17] _onDragOver : ondrop이벤트를 활성화 하기 위해 ondragover에 e.preventDefault() 설정을 했다.</li>\n<li>[19-24] _onDragStart : drag를 위해 요소를 선택하면 발생하는 함수. 여기서는 선택된 요소를 state에 저장하고, 선택된 요소에 grabbing 커서를 주는 css class를 추가한다. 그 외 e.dataTransfer에 대해서는 <a href=\"https://developer.mozilla.org/ko/docs/Web/API/DataTransfer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기</a>를 통해 확인바란다.</li>\n<li>[26-30] _onDragEnd : drop 후 발생하는 이벤트. drag를 위해 선택된 요소에 추가된 css class를 지운다. 추가적으로 grab state를 null로 바꾸는 작업을 해도 된다.</li>\n<li>[32-40] _onDrop : drag를 위해 선택된 요소를 원하는 위치에 놓으면 발생한다. 이때 <strong>리스트를 서로 변경하는 코드를 작성한다.</strong></li>\n</ul>\n<p>다음 포스트는 원하는 위치에 drop 할 경우 그 이외의 요소들이 자동적으로 정렬(?)되는 리스트를 포스팅하겠다.</p>\n<h3 id=\"미리보기\" style=\"position:relative;\"><a href=\"#%EB%AF%B8%EB%A6%AC%EB%B3%B4%EA%B8%B0\" aria-label=\"미리보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>미리보기</h3>\n<p><img src=\"/9b968fd45fe6e760b00687123a9c694d/drag_and_drop_list_sortable.gif\" alt=\"drag_and_drop_list_sortable.gif\"> <em>Sortable List</em></p>","fields":{"slug":"/posts/react-drag-and-drop-list-2","tagSlugs":["/tag/react/","/tag/drag-and-drop/","/tag/list/"]},"frontmatter":{"date":"2020-11-05 00:09:28 GMT+0900","description":"드래그 앤 드롭 - Swap이 가능한 리스트를 라이브러리 없이 만들어보자.","tags":["React","Drag and Drop","List"],"title":"개인 프로젝트 - React로 Drag and Drop List 만들기(Swap) #2","socialImage":{"publicURL":"/static/02212ea91b2835c49f8eac7ceac9cedb/drag_and_drop_list.png"}}}},"pageContext":{"slug":"/posts/react-drag-and-drop-list-2"}},"staticQueryHashes":["251939775","401334301","825871152"]}