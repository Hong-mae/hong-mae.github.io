{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/create-react-blog-with-gatsby-template-3","result":{"data":{"markdownRemark":{"id":"85742e7a-e93b-5c34-a560-4302efb15278","html":"<ul>\n<li><a href=\"/posts/create-react-blog-with-gatsby-template-0\">리액트 + Gatsby 를 이용한 블로그 만들기_#0</a></li>\n<li><a href=\"/posts/create-react-blog-with-gatsby-template-1\">리액트 + Gatsby 를 이용한 블로그 만들기_#1</a></li>\n<li><a href=\"/posts/create-react-blog-with-gatsby-template-2\">리액트 + Gatsby 를 이용한 블로그 만들기_#2</a></li>\n<li><a href=\"/posts/create-react-blog-with-gatsby-template-3\">리액트 + Gatsby 를 이용한 블로그 만들기_#3</a></li>\n<li><a href=\"/posts/create-react-blog-with-gatsby-template-final\">리액트 + Gatsby 를 이용한 블로그 만들기_final</a></li>\n</ul>\n<p>node 프로세스 관리 툴(?)인 PM2에 대해 알아보자.</p>\n<p>서버에서 웹 애플리케이션을 운영할 때 보통 데몬으로 서버를 띄워야 하고 Node.js의 경우 서버가 크래시나면 재시작을 하기 위해서 워치독(watchdog) 류의 프로세스 관리자를 사용하게 된다.</p>\n<p>필자의 경우 node.js에서 많이 알려진 supervisor에서 사용하다가 forever로 갈아타고 마지막으로 pm2를 메인으로 사용하게 됐다.</p>\n<p>forever와 pm2는 둘 다 백그라운드에서 실행이 가능하다. 즉 실행 후 터미널을 종료해도 서버는 그대로 살아있다.</p>\n<p>pm2로 넘어온 이유는 시각적인 요소가 눈에 띄어서 사용중이다.</p>\n<p>설치는 다음 명령어를 사용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">// <span class=\"token function\">npm</span>\n<span class=\"token function\">npm</span> i -g pm2\n// <span class=\"token function\">yarn</span>\n<span class=\"token function\">yarn</span> global <span class=\"token function\">add</span> pm2</code></pre></div>\n<p>pm2를 통해 서버를 실행할 경우 서버 실행하는 코드가 있는 파일을 적어서 실행하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"base\"><pre class=\"language-base\"><code class=\"language-base\">pm2 start [파일명]\n\n// 옛날 express\npm2 start app.js\n\n// 최신 express\npm2 start /bin/www</code></pre></div>\n<p>실행시 다음과 비슷한 화면이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 537px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a3b2f49043b2cc5509d0e1cb8f353b29/b1cde/pm2_start_command.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZ0lEQVQY01WPu07DQBBF/RP8F+IL+AskGjo6ukjQ0NEgRGUkCqgiHoKQhx07cWzH3vixttdOYieBJGxxGYwUieJodmZn7txR2qanvjw8qpvDvXt5oNzJfUX1bs/Vpmarmj5UW72h2jFsNa82O0S53pHNv/6htA0LT8/vcG8aCK9OkVyfwXptomU46OpD9EwX2tCDzTgclsD2OYJkBhYXCLMSebUFCe9Q3DCRlhfLkVjLYA0ZbSHjciuTYimT2adMpiuZUoxEJaO8knHNos459eyYLqlvJZV+kEHnBXg6Q8BzhPT2whQDUYIRTpBiRDU3zNCNBCw+hU9RpzzM5vX/B/VbcY6INBR3kkIzx7V9clLbZiRwdHyCt04ftB0TOnGSChjMQpAXdG6OgRugWH7TckHzDrwoR1ws/gQHTgA6g6iQTJfwaaBxcYmuaSMilx45YlzAZA5YJmrBkR/XBnwS6lsexiT8u/wHdDGqXYPLy3wAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a3b2f49043b2cc5509d0e1cb8f353b29/8ac56/pm2_start_command.webp 240w,\n/static/a3b2f49043b2cc5509d0e1cb8f353b29/d3be9/pm2_start_command.webp 480w,\n/static/a3b2f49043b2cc5509d0e1cb8f353b29/27c24/pm2_start_command.webp 537w\"\n              sizes=\"(max-width: 537px) 100vw, 537px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a3b2f49043b2cc5509d0e1cb8f353b29/8ff5a/pm2_start_command.png 240w,\n/static/a3b2f49043b2cc5509d0e1cb8f353b29/e85cb/pm2_start_command.png 480w,\n/static/a3b2f49043b2cc5509d0e1cb8f353b29/b1cde/pm2_start_command.png 537w\"\n            sizes=\"(max-width: 537px) 100vw, 537px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a3b2f49043b2cc5509d0e1cb8f353b29/b1cde/pm2_start_command.png\"\n            alt=\"pm2_start_command.png\"\n            title=\"pm2_start_command.png\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span> <em>pm2 start 명령어</em></p>\n<p>만약 name 을 변경하고 싶을 경우 다음과 같이 실행하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pm2 start <span class=\"token punctuation\">[</span>파일명<span class=\"token punctuation\">]</span> --name <span class=\"token string\">\"변경할 이름\"</span></code></pre></div>\n<p>현재 pm2로 실행한 서버의 리스트와 상태를 보고싶으면 다음 명령어를 사용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pm2 status<span class=\"token operator\">|</span>list</code></pre></div>\n<p>결과는 위의 사진과 같게 뜬다.</p>\n<p>서버 restart, stop, reload, delete 는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pm2 restart <span class=\"token punctuation\">[</span>id 번호나 name<span class=\"token punctuation\">]</span> // 재시작\npm2 reload <span class=\"token punctuation\">[</span>id 번호나 name<span class=\"token punctuation\">]</span> // 다시 불러오기\npm2 stop <span class=\"token punctuation\">[</span>id 번호나 name<span class=\"token punctuation\">]</span> // 종료\npm2 delete <span class=\"token punctuation\">[</span>id 번호나 name<span class=\"token punctuation\">]</span> // 삭제</code></pre></div>\n<p>restart와 reload는 비슷한 역할을 한다. 서버를 껐다가 다시 실행하거나 새로고침하기 때문이다.</p>\n<p>stop의 경우 서버를 종료한다. 하지만 pm2 status 또는 pm2 list를 실행할 경우 서버상태는 stopped 로 뜨고 리스트에서 삭제되지 않는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 532px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2e62a5b65100a07519b593b1d92bb911/89a37/pm2_stop_command.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABL0lEQVQY0z1PS1KDQBDlTF7BE7l3bbnShRtP4QW8gFqWKYHwHWBgmIHhFwjRpDfTdiZVLl71573q99rxUwZeWsLm/QPm22vY31zBgZC8vsBXWoMXpLCNOXhhAdukhKqdQPUr1HoGPf1Cv5ygm4//cFweoBvF+PbpoRtzZKLDXK+YVB2mXGFWaczr3lbGG8yExqqZkMsBVb/HZjwQVot2+kEnEp2J1WDibjYkMDVVqXeGt6PJlqOR/WJS4ot2MqyZzLYlTo0maUaTU1/Kwbi1NiFpBM0Oa0abICok0sI6DvsTfgcMH56eUegJS0pUEZdJhUxJJFOMKb0cVtuHTGBWdygpsUMu9jU/KohcUJHofHDjp3h3/0gml/dK0lU5R+H6WFOIMBP2wDlEkJRkvLPzHx1zaWHG84t7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2e62a5b65100a07519b593b1d92bb911/8ac56/pm2_stop_command.webp 240w,\n/static/2e62a5b65100a07519b593b1d92bb911/d3be9/pm2_stop_command.webp 480w,\n/static/2e62a5b65100a07519b593b1d92bb911/b5f85/pm2_stop_command.webp 532w\"\n              sizes=\"(max-width: 532px) 100vw, 532px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2e62a5b65100a07519b593b1d92bb911/8ff5a/pm2_stop_command.png 240w,\n/static/2e62a5b65100a07519b593b1d92bb911/e85cb/pm2_stop_command.png 480w,\n/static/2e62a5b65100a07519b593b1d92bb911/89a37/pm2_stop_command.png 532w\"\n            sizes=\"(max-width: 532px) 100vw, 532px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2e62a5b65100a07519b593b1d92bb911/89a37/pm2_stop_command.png\"\n            alt=\"pm2_stop_command.png\"\n            title=\"pm2_stop_command.png\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span> <em>pm2 stop 명령어</em></p>\n<p>delete의 경우도 서버를 종료하지만 서버 리스트에서는 삭제된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 532px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7b642ac32ec1d40401fca59032466622/89a37/pm2_delete_command.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.499999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABKUlEQVQY0y1Pu1LDMBD0f1JSUFIxw09Q8wMMVXoqGoaCYcLDcYITxZblyJIfsmM7CSTdZu2h2NHd3u3uyQtWMd58gfT+DvX1BdzNJarbK/gvr3gPBL7nK/hhjK9gzTrCbJlAmhq66JBVPYzbw/UnVN1xhBcmEp/+EtMfiYXdQjZHRO4AaRukmYMkdNkiNewHzpDTFRRrnW8562DrPYp/eIJpIQXG9ciZaImcdVq1SHancTnOG6iBK1ru9kjcDoZGgjrNOisahMUWK3Lemml+nCHia+vd+I2y/cXHXGDy9My+G2eDmcxKzDYp4qLmtTVmsYapD1C8OkgsFsrCU7xQ0FCQMEwbvle2f5j6IR4eJ8iYmlCgaahshbVOsRkMeXVEA0uNonlE/dCfAfQvaoZgmuMqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7b642ac32ec1d40401fca59032466622/8ac56/pm2_delete_command.webp 240w,\n/static/7b642ac32ec1d40401fca59032466622/d3be9/pm2_delete_command.webp 480w,\n/static/7b642ac32ec1d40401fca59032466622/b5f85/pm2_delete_command.webp 532w\"\n              sizes=\"(max-width: 532px) 100vw, 532px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7b642ac32ec1d40401fca59032466622/8ff5a/pm2_delete_command.png 240w,\n/static/7b642ac32ec1d40401fca59032466622/e85cb/pm2_delete_command.png 480w,\n/static/7b642ac32ec1d40401fca59032466622/89a37/pm2_delete_command.png 532w\"\n            sizes=\"(max-width: 532px) 100vw, 532px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7b642ac32ec1d40401fca59032466622/89a37/pm2_delete_command.png\"\n            alt=\"pm2_delete_command.png\"\n            title=\"pm2_delete_command.png\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span> <em>pm2 delete 명령어</em></p>\n<p>기본적은 pm2 사용법을 알아봤으나 Gatsby를 통해 만든 프로젝트는 app.js나 /bin/www 같은 서버실행 파일이 존재하지 않아 이런 경우는 어떻게 해야하는지 막막하다.</p>\n<p>pm2 start 명령어에는 파일이 없이 npm 명령어를 사용할 수 있다. 즉 <a href=\"/posts/create-react-blog-with-gatsby-template-2\">이전 포스트</a>에서 작성한 “gatsby serve” 를 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pm2 start gatsby --name <span class=\"token string\">\"원하는 이름\"</span> -- serve</code></pre></div>\n<p>보통 이렇게 작성하면 서버가 실행되지만 간혹 gatsby 라는 명령어를 찾지 못해 아래와 같이 gatsby의 경로와 같이 적어주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pm2 start ~/.nvm/versions/node/v14.2.0/bin/gatsby --name <span class=\"token string\">\"원하는 이름\"</span> -- serve</code></pre></div>\n<p>gatsby의 경로를 모를 경우 아래의 명령어로 경로를 찾을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">which</span> gatsby\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> ~/.nvm/versions/node/v14.2.0/bin/gatsby</code></pre></div>\n<p>다음 포스트에서는 기본으로 적용되어있는 plugin과 추가한 plugin들의 설명과 적용법에 대해 포스트하고 길고 긴 포스트를 끝내겠다.</p>","fields":{"slug":"/posts/create-react-blog-with-gatsby-template-3","tagSlugs":["/tag/web-development/","/tag/blog/","/tag/react/","/tag/seo/","/tag/ssr/","/tag/server-side-rendering/","/tag/gatsby/","/tag/pm-2/"]},"frontmatter":{"date":"2020-10-07T00:55:12.000Z","description":"SEO를 지원하는 블로그를 위해 리액트 + Gatsby 이용하여 블로그를 만들자. #3 Gatsby를 실행하는 방법!","tags":["Web Development","Blog","React","SEO","SSR","Server Side Rendering","Gatsby","pm2"],"title":"리액트 + Gatsby 를 이용한 블로그 만들기_#3","socialImage":{"publicURL":"/static/1b703608bc525e55e35d867d2cdd4a49/gatsby_react.png"}}}},"pageContext":{"slug":"/posts/create-react-blog-with-gatsby-template-3"}},"staticQueryHashes":["1118307107","251939775","401334301"]}